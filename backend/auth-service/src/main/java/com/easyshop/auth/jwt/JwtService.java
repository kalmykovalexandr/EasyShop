package com.easyshop.auth.jwt;import io.jsonwebtoken.*;import io.jsonwebtoken.io.*;import io.jsonwebtoken.security.*;import org.springframework.beans.factory.annotation.*;import org.springframework.stereotype.*;import java.security.*;import java.util.*;@Component public class JwtService{@Value("${jwt.secret}") String secret;@Value("${jwt.ttlMinutes}") long ttl;Key key(){return Keys.hmacShaKeyFor(Decoders.BASE64.decode(secret));}public String create(String sub,String role){Date n=new Date(),e=new Date(n.getTime()+ttl*60*1000);return Jwts.builder().setSubject(sub).claim("role",role).setIssuedAt(n).setExpiration(e).signWith(key(),SignatureAlgorithm.HS256).compact();}}
