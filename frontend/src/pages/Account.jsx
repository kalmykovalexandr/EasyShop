import React, { useState } from 'react'
import { api, setToken } from '../lib/api'
export default function Account(){const [loginMsg,setLoginMsg]=useState(''); const [regMsg,setRegMsg]=useState('')
  async function onLogin(e){ e.preventDefault(); setLoginMsg(''); try{ const j = await api('/auth/login',{method:'POST',body:JSON.stringify({email:e.target.email.value, password:e.target.password.value})}); setToken(j.token); setLoginMsg('Вход выполнен') } catch(err){ setLoginMsg(err.message) } }
  async function onRegister(e){ e.preventDefault(); setRegMsg(''); try{ await api('/auth/register',{method:'POST',body:JSON.stringify({email:e.target.email.value, password:e.target.password.value})}); setRegMsg('Готово! Теперь войдите.') } catch(err){ setRegMsg(err.message) } }
  return (<div><div style={{border:'1px solid #eee',borderRadius:14,padding:16,marginBottom:16}}><h2>Вход</h2><form onSubmit={onLogin}><input name="email" placeholder="Email" required/><br/><br/><input name="password" type="password" placeholder="Пароль" required/><br/><br/><button>Войти</button> <span>{loginMsg}</span></form></div><div style={{border:'1px solid #eee',borderRadius:14,padding:16}}><h2>Регистрация</h2><form onSubmit={onRegister}><input name="email" placeholder="Email" required/><br/><br/><input name="password" type="password" placeholder="Пароль (мин. 8)" minLength={8} required/><br/><br/><button>Создать аккаунт</button> <span>{regMsg}</span></form></div></div>) }
